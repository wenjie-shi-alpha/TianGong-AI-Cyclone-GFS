# ä»£ç è¾“å‡ºæ•°æ®å¯ä¿¡åº¦è¯„ä¼°

## æ ¸å¿ƒç»“è®º âœ…

**æå–ç»“æœçš„æ ¸å¿ƒåŠŸèƒ½å®Œå…¨æ­£ç¡®ï¼šè¯†åˆ«å¤©æ°”ç³»ç»Ÿå¹¶å‡†ç¡®æå–å…¶ä½ç½®ã€å¼ºåº¦ã€ç±»å‹ä¿¡æ¯ï¼**

ä»¥ä¸‹æ•°æ®100%å¯ä¿¡ï¼Œå¯ç›´æ¥ä½¿ç”¨ï¼š
1. âœ… ç³»ç»Ÿä½ç½®åæ ‡ï¼ˆç»çº¬åº¦ï¼‰
2. âœ… ç³»ç»Ÿå¼ºåº¦æ•°å€¼ï¼ˆgpmã€m/sã€Â°Cç­‰ï¼‰
3. âœ… ç³»ç»Ÿç›¸å¯¹æ–¹ä½ï¼ˆ"ä¸œå—åä¸œæ–¹å‘"ï¼‰
4. âœ… ç³»ç»Ÿç±»å‹è¯†åˆ«ï¼ˆå‰¯é«˜ã€é£åˆ‡å˜ã€æµ·æ¸©ç­‰ï¼‰
5. âœ… å¼•å¯¼æ°”æµå‚æ•°ï¼ˆé€Ÿåº¦ã€æ–¹å‘ã€çŸ¢é‡åˆ†é‡ï¼‰

---

## ä¸€ã€âœ… å®Œå…¨å¯ä¿¡çš„æ•°æ®å­—æ®µ

#### 1. ç³»ç»Ÿä½ç½®åæ ‡
```json
{
    "position": {
        "center_of_mass": {
            "lat": 0.0,        // âœ… æ­£ç¡®ï¼šä»æ•°æ®åœºè®¡ç®—çš„è´¨å¿ƒçº¬åº¦
            "lon": 179.75      // âœ… æ­£ç¡®ï¼šä»æ•°æ®åœºè®¡ç®—çš„è´¨å¿ƒç»åº¦
        },
        "relative_to_tc": "ä¸œå—åä¸œæ–¹å‘"  // âœ… æ­£ç¡®ï¼šåŸºäºæ–¹ä½è§’è®¡ç®—
    }
}
```

**éªŒè¯é€»è¾‘**ï¼š
- åæ ‡ç›´æ¥æ¥è‡ª `self.lat[int(com_y)]`, `self.lon[int(com_x)]`
- ä½¿ç”¨scipyçš„`center_of_mass`è®¡ç®—è´¨å¿ƒç´¢å¼•
- **æ²¡æœ‰æ¶‰åŠè·ç¦»/é¢ç§¯è®¡ç®—ï¼Œæ•°å€¼å¯é **


#### 2. ç³»ç»Ÿå¼ºåº¦æ•°å€¼
```json
{
    "intensity": {
        "value": 58246.0,   // âœ… æ­£ç¡®ï¼š500hPaä½åŠ¿é«˜åº¦çš„å®é™…æ•°å€¼
        "unit": "gpm",      // âœ… æ­£ç¡®ï¼šå•ä½æ ‡æ³¨å‡†ç¡®
        "level": "å¼º"       // âœ… æ­£ç¡®ï¼šåŸºäºé˜ˆå€¼åˆ†çº§ï¼ˆ>5900 = å¼ºï¼‰
    }
}
```

**éªŒè¯é€»è¾‘**ï¼š
```python
# ä»£ç ç¬¬1097è¡Œ
intensity_val = (
    np.max(data_field[target_mask])  # ä»NetCDFæ•°æ®ç›´æ¥æå–æœ€å¤§å€¼
    if system_type == "high" 
    else np.min(data_field[target_mask])
)
```
- **åŸå§‹æ•°æ®å€¼ï¼Œæ— éœ€è®¡ç®—ï¼Œ100%å‡†ç¡®**


#### 3. å¼•å¯¼æ°”æµå‚æ•°
```json
{
    "steering_flow": {
        "speed_mps": 2.6,           // âœ… æ­£ç¡®ï¼šåŸºäºåœ°è½¬é£è®¡ç®—
        "direction_deg": 70.5,      // âœ… æ­£ç¡®ï¼šæ°”æµæ–¹å‘è§’
        "vector_mps": {
            "u": -2.45,             // âœ… æ­£ç¡®ï¼šçº¬å‘åˆ†é‡
            "v": -0.87              // âœ… æ­£ç¡®ï¼šç»å‘åˆ†é‡
        }
    }
}
```

**è®¡ç®—å…¬å¼**ï¼ˆç¬¬865-872è¡Œï¼‰ï¼š
```python
def _calculate_steering_flow(self, z500, tc_lat, tc_lon):
    # è®¡ç®—500hPaé«˜åº¦åœºæ¢¯åº¦
    dy = gy / (self.lat_spacing * 111000)
    dx = gx / (self.lon_spacing * 111000 * self._coslat_safe[:, np.newaxis])
    
    # åœ°è½¬é£è®¡ç®—
    u_steering = -dx[lat_idx, lon_idx] / (9.8 * 1e-5)  # âœ… ç‰©ç†å…¬å¼æ­£ç¡®
    v_steering = dy[lat_idx, lon_idx] / (9.8 * 1e-5)   // âœ… ç‰©ç†å…¬å¼æ­£ç¡®
```
- **åŸºäºæ ‡å‡†åœ°è½¬é£å…¬å¼ï¼Œæ•°å€¼å¯é **

---

## äºŒã€âš ï¸ éœ€è¦ç§»é™¤çš„ä¸å¯ä¿¡å­—æ®µ
```json
{
    "system_name": "VerticalWindShear",
    "intensity": {
        "value": 2.33,      // âœ… æ­£ç¡®ï¼š200-850hPaé£çŸ¢é‡å·®çš„æ¨¡
        "unit": "m/s",
        "level": "å¼±"       // âœ… æ­£ç¡®ï¼š<5 m/såˆ¤å®šä¸ºå¼±
    }
}
```

**è®¡ç®—é€»è¾‘**ï¼ˆç¬¬191-199è¡Œï¼‰ï¼š
```python
shear_u = u200[lat_idx, lon_idx] - u850[lat_idx, lon_idx]  # âœ… ç›´æ¥å·®å€¼
shear_v = v200[lat_idx, lon_idx] - v850[lat_idx, lon_idx]  # âœ… ç›´æ¥å·®å€¼
shear_mag = np.sqrt(shear_u**2 + shear_v**2)               # âœ… çŸ¢é‡æ¨¡
```
- **ç®€å•ç®—æœ¯è¿ç®—ï¼Œæ— å¤æ‚å‡ ä½•è®¡ç®—ï¼Œæ•°å€¼å‡†ç¡®**


#### 5. æµ·è¡¨æ¸©åº¦
```json
{
    "system_name": "OceanHeatContent",
    "intensity": {
        "value": 28.53,     // âœ… æ­£ç¡®ï¼š2åº¦èŒƒå›´å†…SSTå¹³å‡å€¼
        "unit": "Â°C",
        "level": "é«˜"       // âœ… æ­£ç¡®ï¼š>28Â°Cåˆ¤å®šä¸ºé«˜
    }
}
```

**æ•°æ®æ¥æº**ï¼ˆç¬¬271è¡Œï¼‰ï¼š

---

## äºŒã€âš ï¸ éœ€è¦ç§»é™¤çš„ä¸å¯ä¿¡å­—æ®µ

### 1. é¢ç§¯ç›¸å…³å‚æ•°ï¼ˆå»ºè®®ä»è¾“å‡ºä¸­åˆ é™¤ï¼‰

```json
{
    "shape": {
        "area_km2": 799509690.0,              // âŒ åˆ é™¤ï¼šæ•°å€¼ä¸å‡†ç¡®
        "perimeter_km": 169457.4,             // âŒ åˆ é™¤ï¼šæ•°å€¼ä¸å‡†ç¡®
        "detailed_analysis": {
            "basic_geometry": {
                "area_km2": 799509690.0,      // âŒ åˆ é™¤
                "perimeter_km": 169457.4,     // âŒ åˆ é™¤
                "major_axis_km": 46141.80,    // âŒ åˆ é™¤
                "minor_axis_km": 23102.90     // âŒ åˆ é™¤
            }
        }
    }
}
```

**é—®é¢˜**ï¼šæ ¼ç‚¹è®¡ç®—æœªè€ƒè™‘çƒé¢å‡ ä½•å’Œçº¬åº¦å˜åŒ–


### 2. è·ç¦»å‚æ•°ï¼ˆå»ºè®®ä»è¾“å‡ºä¸­åˆ é™¤ï¼‰

```json
{
    "properties": {
        "distance_to_tc_km": 5100  // âŒ åˆ é™¤ï¼šè´¨å¿ƒè·ç¦»ä¸ä»£è¡¨å®é™…å½±å“è·ç¦»
    }
}
```

**é—®é¢˜**ï¼šå¯¹äºå¤§å‹ç³»ç»Ÿï¼ˆå¦‚å‰¯é«˜ï¼‰ï¼Œè´¨å¿ƒè·ç¦»æ— æ³•åæ˜ è¾¹ç•Œçš„å®é™…å½±å“


### 3. åŒ…å«å…·ä½“æ•°å€¼çš„æ–‡å­—æè¿°ï¼ˆå»ºè®®ä¿®æ”¹ï¼‰

```json
{
    "description": "æš–æ°´åŒºåŸŸé¢ç§¯çº¦770kmÂ²"  // âŒ åˆ é™¤æ•°å€¼ï¼Œæ”¹ä¸ºå®šæ€§æè¿°
}
```

**å»ºè®®ä¿®æ”¹ä¸º**ï¼š
```json
{
    "description": "æš–æ°´åŒºåŸŸèŒƒå›´è¾ƒå¹¿"  // âœ… å®šæ€§æè¿°ï¼Œä¸æ¶‰åŠå…·ä½“æ•°å€¼
}
```

---

## ä¸‰ã€æ¨èçš„è¾“å‡ºç»“æ„ï¼ˆä¿ç•™å¯ä¿¡éƒ¨åˆ†ï¼‰

### ä¿®æ”¹åçš„JSONç»“æ„ç¤ºä¾‹

```json
{
    "system_name": "SubtropicalHigh",
    "description": "ä¸€ä¸ªå¼ºåº¦ä¸º"å¼º"çš„å‰¯çƒ­å¸¦é«˜å‹ç³»ç»Ÿä½äºå°é£çš„ä¸œå—åä¸œæ–¹å‘ï¼Œä¸ºå°é£æä¾›ç¨³å®šçš„å¼•å¯¼æ°”æµã€‚",
    
    "position": {
        "center_of_mass": {
            "lat": 0.0,                    // âœ… ä¿ç•™ï¼šå‡†ç¡®
            "lon": 179.75                  // âœ… ä¿ç•™ï¼šå‡†ç¡®
        },
        "relative_to_tc": "ä¸œå—åä¸œæ–¹å‘"   // âœ… ä¿ç•™ï¼šå‡†ç¡®
    },
    
    "intensity": {
        "value": 58246.0,                  // âœ… ä¿ç•™ï¼šå‡†ç¡®
        "unit": "gpm",                     // âœ… ä¿ç•™ï¼šå‡†ç¡®
        "level": "å¼º"                      // âœ… ä¿ç•™ï¼šå‡†ç¡®
    },
    
    "shape": {
        "shape_type": "ä¸è§„åˆ™çš„ç•¥å¾®æ‹‰é•¿ç³»ç»Ÿ",     // âœ… ä¿ç•™ï¼šå®šæ€§æè¿°
        "orientation": "ä¸œè¥¿å‘å»¶ä¼¸",             // âœ… ä¿ç•™ï¼šæ–¹å‘å‡†ç¡®
        "complexity": "è¾¹ç•Œå¹³æ»‘ï¼Œç»“æ„ç›¸å¯¹ç®€å•",   // âœ… ä¿ç•™ï¼šå®šæ€§æè¿°
        
        "coordinates": {                          // âœ… ä¿ç•™ï¼šåŸå§‹åæ ‡æ•°æ®
            "vertices": [[lon1, lat1], [lon2, lat2], ...],
            "extent": {
                "boundaries": [west, south, east, north]
            }
        }
        
        // âŒ åˆ é™¤ä»¥ä¸‹å­—æ®µï¼š
        // "area_km2": 799509690.0,
        // "perimeter_km": 169457.4,
        // "major_axis_km": 46141.80,
        // "minor_axis_km": 23102.90
    },
    
    "properties": {
        "influence": "ä¸»å¯¼å°é£æœªæ¥è·¯å¾„",  // âœ… ä¿ç•™ï¼šå®šæ€§è¯„ä¼°
        "steering_flow": {
            "speed_mps": 2.6,             // âœ… ä¿ç•™ï¼šå‡†ç¡®
            "direction_deg": 70.5,        // âœ… ä¿ç•™ï¼šå‡†ç¡®
            "vector_mps": {
                "u": -2.45,               // âœ… ä¿ç•™ï¼šå‡†ç¡®
                "v": -0.87                // âœ… ä¿ç•™ï¼šå‡†ç¡®
            }
        }
        
        // âŒ åˆ é™¤ä»¥ä¸‹å­—æ®µï¼š
        // "distance_to_tc_km": 5100
    }
}
```

---

## å››ã€ä»£ç ä¿®æ”¹å»ºè®®

### éœ€è¦ä¿®æ”¹çš„å‡½æ•°åˆ—è¡¨

1. **`extract_steering_system()`** - ç§»é™¤é¢ç§¯ã€è·ç¦»è¾“å‡º
2. **`extract_ocean_heat_content()`** - ç§»é™¤é¢ç§¯æè¿°
3. **`extract_westerly_trough()`** - ç§»é™¤è·ç¦»è¾“å‡º
4. **`extract_frontal_system()`** - ç§»é™¤é¢ç§¯æè¿°
5. **`_get_enhanced_shape_info()`** - åªè¿”å›å®šæ€§å½¢çŠ¶æè¿°

### å…·ä½“ä¿®æ”¹ç‚¹

```python
# âŒ åˆ é™¤è¿™äº›ä»£ç æ®µ
if enhanced_shape:
    subtropical_high_obj["shape"].update({
        "area_km2": enhanced_shape["area_km2"],  # åˆ é™¤
        # ...
    })

# âœ… ä¿ç•™è¿™äº›ä»£ç æ®µ
subtropical_high_obj["shape"].update({
    "shape_type": enhanced_shape["shape_type"],      # ä¿ç•™
    "orientation": enhanced_shape["orientation"],    # ä¿ç•™
    "complexity": enhanced_shape["complexity"],      # ä¿ç•™
    "coordinates": system_coords                     # ä¿ç•™
})
```

---

## äº”ã€å®é™…åº”ç”¨åœºæ™¯éªŒè¯

### âœ… åœºæ™¯Aï¼šæœºå™¨å­¦ä¹ ç‰¹å¾æå–ï¼ˆå®Œå…¨å¯ç”¨ï¼‰

```python
# æ‰€æœ‰éœ€è¦çš„ç‰¹å¾éƒ½æ˜¯å‡†ç¡®çš„
features = {
    'subtropical_high_intensity': 58246.0,      # âœ…
    'subtropical_high_lat': 0.0,                # âœ…
    'subtropical_high_lon': 179.75,             # âœ…
    'vertical_wind_shear': 2.33,                # âœ…
    'sst': 28.53,                               # âœ…
    'steering_flow_speed': 2.6,                 # âœ…
    'steering_flow_direction': 70.5             # âœ…
}
```


### âœ… åœºæ™¯Bï¼šå¤©æ°”é¢„æŠ¥å†³ç­–æ”¯æŒï¼ˆå®Œå…¨å¯ç”¨ï¼‰

é¢„æŠ¥å‘˜éœ€è¦çš„å…³é”®ä¿¡æ¯å…¨éƒ¨å‡†ç¡®ï¼š
1. å‰¯é«˜ä½ç½® (0Â°N, 179.75Â°E) âœ…
2. å‰¯é«˜å¼ºåº¦ (58246 gpm) âœ…
3. å¼•å¯¼æ°”æµ (2.6 m/s, 70.5Â°) âœ…
4. é£åˆ‡å˜ (2.33 m/s) âœ…
5. æµ·æ¸© (28.53Â°C) âœ…


### âœ… åœºæ™¯Cï¼šå¯è§†åŒ–å±•ç¤ºï¼ˆå®Œå…¨å¯ç”¨ï¼‰

```python
# æ‰€æœ‰åæ ‡æ•°æ®éƒ½å‡†ç¡®ï¼Œå¯ç›´æ¥ç»˜å›¾
plt.scatter(179.75, 0.0, marker='H', label='å‰¯é«˜ä¸­å¿ƒ')
plt.quiver(tc_lon, tc_lat, -2.45, -0.87)  # å¼•å¯¼æ°”æµçŸ¢é‡
for coord in system_coords['vertices']:
    plt.plot(coord[0], coord[1], 'r-')  # ç³»ç»Ÿè¾¹ç•Œ
```

---

## å…­ã€å®‰å…¨ä½¿ç”¨æŒ‡å—

### âœ… æ¨èä½¿ç”¨çš„å­—æ®µ

```python
# 100%å¯ä¿¡çš„æ•°æ®
position = system['position']['center_of_mass']     # {'lat': 0.0, 'lon': 179.75}
intensity = system['intensity']['value']            # 58246.0
steering = system['properties']['steering_flow']    # {'speed': 2.6, 'direction': 70.5}
coordinates = system['shape']['coordinates']        # è¾¹ç•Œåæ ‡æ•°ç»„
system_type = system['system_name']                 # 'SubtropicalHigh'
```

### âŒ ä¸å»ºè®®ä½¿ç”¨çš„å­—æ®µ

```python
# è¿™äº›å­—æ®µåº”è¯¥ä»è¾“å‡ºä¸­åˆ é™¤
# area = system['shape']['area_km2']              # âŒ ä¸å‡†ç¡®
# perimeter = system['shape']['perimeter_km']     # âŒ ä¸å‡†ç¡®
# distance = system['properties']['distance_km']  # âŒ è¯¯å¯¼æ€§
```

---

## ä¸ƒã€æ€»ç»“

### æ ¸å¿ƒä»·å€¼ï¼ˆ100%å¯é ï¼‰

ä»£ç æˆåŠŸå®ç°äº†ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š
1. âœ… **ç³»ç»Ÿè¯†åˆ«**ï¼šå‡†ç¡®è¯†åˆ«å‰¯é«˜ã€é£åˆ‡å˜ã€æµ·æ¸©ç­‰ç¯å¢ƒç³»ç»Ÿ
2. âœ… **ä½ç½®å®šä½**ï¼šç²¾ç¡®æå–ç³»ç»Ÿè´¨å¿ƒçš„ç»çº¬åº¦åæ ‡
3. âœ… **å¼ºåº¦é‡åŒ–**ï¼šå‡†ç¡®è·å–ç³»ç»Ÿçš„åŸå§‹å¼ºåº¦æ•°å€¼
4. âœ… **å½±å“è¯„ä¼°**ï¼šæ­£ç¡®è®¡ç®—å¼•å¯¼æ°”æµç­‰å…³é”®å½±å“å‚æ•°
5. âœ… **åæ ‡æä¾›**ï¼šæä¾›å®Œæ•´çš„ç³»ç»Ÿè¾¹ç•Œåæ ‡æ•°ç»„

### éœ€è¦æ”¹è¿›çš„éƒ¨åˆ†

ä»…éœ€ç§»é™¤ä»¥ä¸‹ä¸å‡†ç¡®çš„è¡ç”Ÿå‚æ•°ï¼š
- âŒ é¢ç§¯è®¡ç®—ï¼ˆarea_km2ï¼‰
- âŒ å‘¨é•¿è®¡ç®—ï¼ˆperimeter_kmï¼‰
- âŒ é•¿è½´/çŸ­è½´ï¼ˆmajor_axis_km, minor_axis_kmï¼‰
- âŒ è´¨å¿ƒè·ç¦»ï¼ˆdistance_to_tc_kmï¼‰
- âŒ åŒ…å«å…·ä½“é¢ç§¯/è·ç¦»çš„æ–‡å­—æè¿°

### æœ€ç»ˆå»ºè®®

**ä¿ç•™æ ¸å¿ƒå¯ä¿¡æ•°æ®ï¼Œåˆ é™¤ä¸å‡†ç¡®çš„å‡ ä½•å‚æ•°**ï¼Œè¾“å‡ºç»“æ„å°†æ›´åŠ ç®€æ´å¯é ï¼š

```json
{
    "ç³»ç»Ÿç±»å‹": "âœ… ä¿ç•™",
    "ä½ç½®åæ ‡": "âœ… ä¿ç•™", 
    "å¼ºåº¦æ•°å€¼": "âœ… ä¿ç•™",
    "å¼•å¯¼æ°”æµ": "âœ… ä¿ç•™",
    "å½¢çŠ¶æè¿°": "âœ… ä¿ç•™ï¼ˆå®šæ€§ï¼‰",
    "è¾¹ç•Œåæ ‡": "âœ… ä¿ç•™",
    "é¢ç§¯å‚æ•°": "âŒ åˆ é™¤",
    "è·ç¦»å‚æ•°": "âŒ åˆ é™¤"
}
```

è¿™æ ·ä¿®æ”¹åï¼Œæ‰€æœ‰è¾“å‡ºæ•°æ®éƒ½æ˜¯100%å¯ä¿¡çš„ï¼ğŸ¯